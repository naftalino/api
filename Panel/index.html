<!-- index.html -->
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cadastrar Carta</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body>
  <div id="app" class="container py-5">
    <h1 class="mb-4">Cadastrar Carta</h1>
    <form @submit.prevent="submitCard">
      <div class="mb-3">
        <label class="form-label">Nome</label>
        <input type="text" v-model="card.name" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Thumb URL</label>
        <input type="url" v-model="card.thumbUrl" class="form-control">
      </div>

      <div class="mb-3">
        <label class="form-label">Raridade</label>
        <select v-model="card.rarity" class="form-select">
          <option value="common">Comum</option>
          <option value="rare">Rara</option>
          <option value="epic">Épica</option>
          <option value="legendary">Lendária</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Valor</label>
        <input type="number" v-model.number="card.value" class="form-control" min="1">
      </div>

      <div class="mb-3">
        <label class="form-label">Série</label>
        <select v-model="card.serieId" class="form-select" required>
          <option disabled value="">Selecione uma série</option>
          <option v-for="serie in series" :key="serie.id" :value="serie.id">
            {{ serie.name }}
          </option>
        </select>
      </div>

      <button type="submit" class="btn btn-primary">Salvar</button>
    </form>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@3.4.21/dist/vue.global.prod.js"></script>
  <script>
    const { createApp } = Vue

    createApp({
      data() {
        return {
          card: {
            name: '',
            thumbUrl: 'https://placehold.co/450x700/png',
            rarity: 'common',
            value: 100,
            serieId: 1
          },
          series: [1, 2, 3, 4]
        }
      },    
      mounted() {
        // Chamar API para buscar as séries
        fetch('http://localhost:5072/cards') // Substituir pelo seu endpoint real
          .then(res => res.json())
          .then(data => this.series = data)
      },
      methods: {
        submitCard() {
          // Submeter o card via POST
          fetch('http://localhost:5072/card', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(this.card)
          })
          .then(res => {
            if (!res.ok) throw new Error("Erro ao salvar");
            alert("Carta cadastrada com sucesso!");
          })
          .catch(err => alert(err.message));
        }
      }
    }).mount('#app')
  </script>
</body>
</html>
